<!DOCTYPE html>
<html>
<head>
    <title>Bytiky</title>
    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/common.js"></script>
    <script src="js/map.js"></script>
    <script src="js/nouislider.min.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/rest.js"></script>
    <script src="js/facebook.js"></script>
    <script src="js/wNumb.js"></script>
    <script src="js/foundation.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/map.css">
    <link rel="stylesheet" type="text/css" href="css/nouislider.min.css">
    <link rel="stylesheet" type="text/css" href="css/foundation.min.css">
    <meta name="viewport" content="width=device-width">
</head>

<body>

<script>
    window.fbAsyncInit = function() {
        FB.init({
            appId : '1648440438752990',
            cookie : true, // enable cookies to allow the server to access 
            // the session
            xfbml : true, // parse social plugins on this page
            version : 'v2.5' // use version 2.2
        });

        // Now that we've initialized the JavaScript SDK, we call 
        // FB.getLoginStatus().  This function gets the state of the
        // person visiting this page and can return one of three states to
        // the callback you provide.  They can be:
        //
        // 1. Logged into your app ('connected')
        // 2. Logged into Facebook, but not your app ('not_authorized')
        // 3. Not logged into Facebook and can't tell if they are logged into
        //    your app or not.
        //
        // These three cases are handled in the callback function.

        FB.getLoginStatus(function(response) {
            statusChangeCallback(response);
        });

    };

    // Load the SDK asynchronously
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id))
            return;
        js = d.createElement(s);
        js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

</script>

<!--
Below we include the Login Button social plugin. This button uses
the JavaScript SDK to present a graphical Login button that triggers
the FB.login() function when clicked.
-->

<div id="facebookLoginButton">
    <fb:login-button  scope="public_profile,email" onlogin="checkLoginState();" auto_logout_link="true"></fb:login-button>
</div>

<div id="content">
    <div id="map"></div>
    
    <div onclick="toggleSettings();" class="menuButton"></div>
    
    <div id="settings" style="display: none">
        <div class="row">
            <div class="small-3 medium-2 large-1 columns"><span>m<sup>2</sup></span></div>
            <div id="sizeSlider" class="small-9 medium-6 large-4 columns slidingFilter"></div>
            <div class="medium-4 large-7 columns"></div>
        </div>
        <div class="row">
            <div class="small-3 medium-2 large-1 columns"><span>Kč</span></div>
            <div id="priceSlider" class="small-9 medium-6 large-4 columns slidingFilter"></div>
            <div class="medium-4 large-7 columns"></div>
        </div>
        <div class="row">
            <div class="small-3 medium-2 large-1 columns"><span>Kč per m<sup>2</sup></span></div>
            <div id="pricePerSquaredMeterSlider" class="small-9 medium-6 large-4 columns slidingFilter"></div>
            <div class="medium-4 large-7 columns"></div>
        </div>
        <div class="row">
            <div class="small-3 medium-2 large-1 columns"><span>Coloring by</span></div>
            <div class="columns small-9 medium-10 large-11">
                <a class="button" id="sizeSchemeButton" onclick="setColoringScheme('size');">Size</a>
                <a class="button" id="priceSchemeButton" onclick="setColoringScheme('price');">Price</a>
                <a class="button" id="ppm2SchemeButton" onclick="setColoringScheme('ppm2');">Price per m<sup>2</sup></a>
                <a class="button success" id="timeSchemeButton" onclick="setColoringScheme('time');">Last Updated</a>
            </div>
        </div>
    </div>
</div>

<script>
    var map;
    var dragging = false;
    
    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 14
        });
        center();

        map.addListener('bounds_changed', function() {
            if (!dragging) {
                loadAll();
            }
        });

        map.addListener('dragstart', function() {
            dragging = true;
        });

        map.addListener('dragend', function() {
            dragging = false;
            loadAll();
        });

        initSliders();

    }
    
</script>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?v=3.23&key=AIzaSyC1Z6lrl0vLeeihVFwWZekBGb4_7VPUUEY&callback=initMap">
</script>

</body>

</html>